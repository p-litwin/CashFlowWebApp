{% extends "base.html" %}

{% block title %}CashFlowApp - Lista transakcji{% endblock %}

{% block body %}

{% include "navbar.html" %}
<div class="container-fluid main-content">
  <div class="row site-title">
    <h1>Lista transakcji</h1>
  </div>
  <!-- Button trigger modal -->
  <!-- <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
      +
    </button>
    <ul class="dropdown-menu">
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
        Dodaj wydatek
      </button>
      <li><button class="dropdown-item" type="button">Another action</button></li>
      <li><button class="dropdown-item" type="button">Something else here</button></li>
    </ul>
  </div> -->
  <!-- End button trigger -->


  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="post" id="expenseForm" action="/expenses/add">
            <input type="hidden" name="user_id" value="{{ current_user.userId }}">

            <div class="form-outline  mb-4 has-validation">
              <label class="form-label" for="amount">Kwota</label>
              <input class="form-control auto-highlight" type="number" id="amount" min="0.00" step="0.01" name="amount"
                value="{% if expense.amount is not empty %}{{expense.amount}}{% else %}0,00{% endif %}" required>
            </div>

            <div class="form-outline mb-4 has-validation">
              <input class="form-control single-date-picker" type="text" id="expenseDate" name="date"
                value="{% if expense.date is not empty %}{{expense.date}}{% else %}{{current_date}}{% endif %}"
                pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}" readonly>
              <label class="form-label" for="expenseDate">Data (RRRR-MM-DD)</label>
            </div>


            <div class="form-outline mb-4 has-validation">
              <select class="form-control" id="paymentMethod" name="payment_method" placeholder="Sposób płatności">
                <option value=""></option>
                {% for method in payment_methods %}
                {% if method.id == last_expense_payment_method %}
                <option value="{{ method.id }}" selected>{{ method.name }}</option>
                {% else %}
                <option value="{{ method.id }}">{{ method.name }}</option>
                {% endif %}
                {% endfor %}
              </select>
              <label class="form-label" for="paymentMethod">Sposób płatności:</label>
            </div>


            <div class="form-outline mb-4 has-validation">
              <select class="form-control" id="expenseCategory" placeholder="Kategoria" name="category">
                <option value=""></option>
                {% for category in expenses_categories %}
                {% if category.id == last_expense_category %}
                <option value="{{ category.id }}" selected>{{ category.name }}</option>
                {% else %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endif %}
                {% endfor %}
              </select>
              <label class="form-label" for="expenseCategory">Kategoria:</label>
            </div>


            <div class="form-outline mb-2 has-validation">
              <textarea class="form-control" id="expenseComment" name="comment"></textarea>
              <label class="form-label" for="expenseComment">Komentarz:</label>
            </div>

            <div class="row buttons">
              <div class="col-6">
                <a href="\" class="btn btn-secondary btn-block btn-lg" role="button">Anuluj</a>
              </div>
              <div class="col-6">
                <button class="btn btn-primary btn-block btn-lg" type="submit">Dodaj</button>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal end -->
  <!-- {% if transactions %}
      <div class="mt-0 mb-0 bg-white shadow-sm   fluid-container text-left">
          <div class="row pt-1 pb-1 border-end fw-bold border-bottom">
              <div class="col-sm-3 ps-4 pe-2 no-wrap-text border-end">Kategoria</div>
              <div class="col-sm-2 ps-2 pe-2 border-end">Data</div>
              <div class="col-sm-5 ps-4 pe-2 no-wrap-text border-end">Opis</div>
              <div class="col-sm-2 ps-4 pe-2 amount-text border-end">Kwota</div>
          </div>

    {% for transaction in transactions %}
        <div class="row pt-1 pb-1 border-bottom">
          <div class="col-sm-3 ps-4 pe-2 no-wrap-text border-end" title="{{transaction.name}}">{{transaction.name}}</div>
          <div class="col-sm-2 ps-2 pe-2 border-end">{{transaction.date}}</div>
          <div class="col-sm-5 ps-4 pe-2 no-wrap-text border-end" title="{{transaction.comment}}">{{transaction.comment}}</div>
          <div class="col-sm-2 ps-4 pe-2 amount-text border-end">{{transaction.amount}} zł</div>
          
        </div>
        {% endfor %}
      </div>
  {% else %}
  No transactions to show
  {% endif %} -->

  {% if transactions %}
        {% for transaction in transactions %}
        <div class="card shadow mb-1">
          <div class="card-body row ps-2 pt-2 pb-2 pe-0">
            <div class="col-lg-10 col-md-9 col-9 row">
              {% if transaction.comment is empty %}
                <div class="col-sm-3 col-md-5 no-wrap-text text-body-secondary" title="Brak opisu">(Brak opisu)</div>
              {% else %}
                <div class="col-sm-5 col-md-5  no-wrap-text" title="{{transaction.comment}}">{{transaction.comment}}</div>
              {% endif %}
              <div class="col-sm-2 col-md-2 ">{{transaction.date}}</div>
              <div class="col-sm-5 col-md-5  no-wrap-text" title="{{transaction.name}}">{{transaction.name}}</div>
            </div>
            <div class="col-lg-2 col-md-3 col-3 align-middle">
              <div class="row ">  
                <div class="col-11 amount-text text-center">{{transaction.amount}} zł</div>
                <div class="col-1 ps-0 pe-0 text-end"><i class="fa-solid fa-ellipsis-vertical"></i></div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
  {% else %}
  No transactions to show
  {% endif %}

  <nav class="mt-4">
    <ul class="pagination justify-content-center">
      {% if page == 1 %}
        <li class="page-item page-link"><i class="fa-solid fa-angles-left" style="color: #c0c0c0;"></i></li>
      {% else %}
        <li class="page-item"><a class="page-link" sr-only="Pierwsza strona" title="Pierwsza strona" href="/transactions-list/show/1"><i class="fa-solid fa-angles-left"></i></a></li>
      {% endif %}
      {% if page == 1 %}
        <li class="page-item page-link"><i class="fa-solid fa-angle-left" style="color: #c0c0c0;"></i></li>
      {% else %}
        <li class="page-item"><a class="page-link" sr-only="Poprzednia strona" title="Poprzednia strona" href="/transactions-list/show/{{previous_page}}"><i class="fa-solid fa-angle-left"></i></a></li>
      {% endif %}
      <li class="page-item"><span class="page-link">Strona {{page}} z {{last_page}}</span></li>
      {% if page >= last_page %}
        <li class="page-item page-link"><i class="fa-solid fa-angle-right" style="color: #c0c0c0;" ></i></li>
      {% else %}
        <li class="page-item"><a class="page-link" sr-only="Następna strona" title="Następna strona" href="/transactions-list/show/{{next_page}}"><i class="fa-solid fa-angle-right"></i></a></li>
      {% endif %}
      {% if page == last_page %}
        <li class="page-item page-link"><i class="fa-solid fa-angles-right" style="color: #c0c0c0;" ></i></li>
      {% else %}
        <li class="page-item"><a class="page-link" sr-only="Ostatnia strona" title="Ostatnia strona" href="/transactions-list/show/{{last_page}}"><i class="fa-solid fa-angles-right"></i></a></li>
      {% endif %}
    </ul>
  </nav>



</div>
{% endblock %}